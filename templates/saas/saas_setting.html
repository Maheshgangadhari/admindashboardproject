<!DOCTYPE html>

{% extends 'base.html'%}
{% load static %}

  {% block title %}
      Affiliate Script - ADMIN PANEL
  {% endblock %}

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css' %}">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  	{%block body_block%}

<div class="main">
    <div class="overly"></div>
{#    nav#}
    {% include 'navgation.html' %}
        <div class="dashboard-wrap">
            <div class="dashboard-main-right">
                {% include 'rightheader.html' %}

                    <div class="server-errors">
                    </div>
                    <script>
                        function sessionTimeout() {
                            var dt = new Date();
                            let distance = (GlobaleCountDownDate - dt.getTime()) / 1000;

                            let h = Math.floor(distance / 3600);
                            let m = Math.floor(distance % 3600 / 60);
                            let s = Math.floor(distance % 3600 % 60);

                            let string = "";

                            string += (h > 0) ? ('0' + h).slice(-2) + ":" : "00:";

                            string += (m > 0) ? ('0' + m).slice(-2) + ":" : "00:";

                            string += (s > 0) ? ('0' + s).slice(-2) + "" : "00";

                            $(".dashboard-refresh em").text(string);

                            if (distance <= 0) {
                                window.location.replace('logout');
                                clearInterval(GlobaleCountDownDateInterval);
                            }
                        }

                        var dt = new Date();
                        var GlobaleCountDownDate = dt.setTime(dt.getTime() + (1800 * 1000));

                        sessionTimeout();
                        var GlobaleCountDownDateInterval = setInterval(sessionTimeout, 100);

                        $(document).ajaxComplete(function(event, request, settings) {
                            let parts = settings.url.split("/");
                            let last_part = parts[parts.length - 1];
                            if (last_part != "ajax_dashboard") {
                                var dt = new Date();
                                var GlobaleCountDownDate = dt.setTime(dt.getTime() + (1800 * 1000));
                            }
                        });
                    </script>
                    <div class="content-wrapper">
                        <div class="card">
                            <div class="card-body">
                                <form class="form-horizontal" method="post" action="" enctype="multipart/form-data" id="setting-form">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <ul class="nav nav-pills nav-stacked setting-nnnav" role="tablist">
                                                <li class="nav-item">
                                                    <a class="nav-link active show" data-toggle="tab" href="#market_vendor-setting" role="tab">Vendor Market Tools</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="#vendor_setting" role="tab" data-toggle="tab">Vendor Store module</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="#vendor_deposite_setting" role="tab" data-toggle="tab">Vendor Deposit Settings</a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="#vendor_permission_setting" role="tab" data-toggle="tab">Vendor Permission Settings</a>
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="col-sm-12">
                                            <div class="tab-content">
                                                <div class="tab-pane p-3 active show" id="market_vendor-setting" role="tabpanel">

                                                    <div class="form-group">
                                                        <label class="control-label">Status</label>
                                                        <select class="form-control" name="market_vendor[marketvendorstatus]">
										<option value="0">Disable</option>
										<option value="1" selected>Enable</option>
									</select>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-sm-6">
                                                            <div class="custom-card card">
                                                                <div class="card-header">
                                                                    <p class="text-center">Admin Sale Commission From Vendors</p>
                                                                </div>

                                                                <div class="card-body">
                                                                    <div class="row">
                                                                        <div class="col-sm-6">
                                                                            <div class="form-group">
                                                                                <label class="control-label">Commission Type</label>
                                                                                <select name="market_vendor[commission_type]" class="form-control">
																<option value="">Select Product Commission Type</option>
																<option selected value="percentage">Percentage(%)</option>
																<option  value="fixed">Fixed</option>
															</select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-sm-6">
                                                                            <div class="form-group">
                                                                                <label class="control-label">
																Commission For Sale [ % ] 
															</label>
                                                                                <div class="input-group">
                                                                                    <div class="input-group-prepend">
                                                                                        <span class="input-group-text">
																		%																	</span>
                                                                                    </div>
                                                                                    <input class="form-control" name="market_vendor[commission_sale]" type="number" value="5">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group">
                                                                        <label class="control-label">Sale Status</label>
                                                                        <div>
                                                                            <div class="radio radio-inline"> <label> <input type="radio" checked="" name="market_vendor[sale_status]" value="0"> Disable </label> </div>
                                                                            <div class="radio radio-inline"> <label> <input checked type="radio" name="market_vendor[sale_status]" value="1"> Enable </label> </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>


                                                        <div class="col-sm-6">
                                                            <div class="custom-card card">
                                                                <div class="card-header">
                                                                    <p class="text-center">Admin Click Commission From Vendors</p>
                                                                </div>

                                                                <div class="card-body">

                                                                    <div class="row">
                                                                        <div class="col-sm-12">
                                                                            <div class="form-group">
                                                                                <label class="control-label">Click Allow</label>
                                                                                <select name="market_vendor[click_allow]" class="form-control">
																<option  selected  value="single">Allow Single Click</option>
																<option   value="multiple">Allow Multi Click</option>
															</select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-sm-6">
                                                                            <div class="form-group">
                                                                                <label class="control-label">Number Of Click</label>
                                                                                <input class="form-control" name="market_vendor[commission_number_of_click]" type="number" value="1">
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-sm-6">
                                                                            <div class="form-group">
                                                                                <label class="control-label">Amount Per Click</label>
                                                                                <div class="input-group">
                                                                                    <div class="currency-symbol">$</div>
                                                                                    <input class="form-control" name="market_vendor[commission_click_commission]" type="number" value="0.1">
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>


                                                                    <div class="form-group">
                                                                        <label class="control-label">Click Status</label>
                                                                        <div>
                                                                            <div class="radio radio-inline"> <label> <input type="radio" checked="" name="market_vendor[click_status]" value="0"> Disable </label> </div>
                                                                            <div class="radio radio-inline"> <label> <input type="radio" checked name="market_vendor[click_status]" value="1"> Enable </label> </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div role="tabpanel" class="tab-pane p-3" id="vendor_setting">
                                                    <div class="form-group">
                                                        <label class="control-label">Status</label>
                                                        <select class="form-control" name="vendor[storestatus]">
										<option value="0">Disable</option>
										<option value="1" selected>Enable</option>
									</select>
                                                    </div>


                                                    <div class="row">
                                                        <div class="col-sm-12">
                                                            <div class="custom-card card">
                                                                <div class="card-header">
                                                                    <p class="text-center">Sale & Click Admin Fee From Vendors</p>
                                                                </div>
                                                                <div class="card-body">

                                                                    <div class="form-group">
                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <label class="control-label">Click Commission</label>
                                                                                <div class="form-group">
                                                                                    <div class="input-group mt-2">
                                                                                        <div class="input-group-prepend"><span class="input-group-text">Click</span></div>
                                                                                        <input name="vendor[admin_click_count]" class="form-control" value="1" type="text" placeholder='Clicks'>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-sm-6">
                                                                                <div class="form-group">
                                                                                    <label class="control-label m-0 d-block">&nbsp;</label>
                                                                                    <div class="input-group mt-2">
                                                                                        <div class="currency-symbol mt-2">$</div>
                                                                                        <input name="vendor[admin_click_amount]" class="form-control mt-2" value="1" type="number" placeholder='Amount'>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <div class="form-group">
                                                                        <div class="row">
                                                                            <div class="col-sm-6">
                                                                                <label class="control-label">Sale Commission</label>
                                                                                <div>
                                                                                    <select name="vendor[admin_sale_commission_type]" class="form-control admin_sale_commission_type">
																																			<option selected value="percentage">Percentage(%)</option>
																																			<option  value="fixed">Fixed</option>
																																	</select>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-sm-6">
                                                                                <div class="toggle-container">
                                                                                    <div class="percentage-value d-none">
                                                                                        <div class="form-group">
                                                                                            <label class="control-label m-0 d-block">&nbsp;</label>
                                                                                            <div class="input-group">
                                                                                                <div class="currency-symbol mt-2">%</div>
                                                                                                <input name="vendor[admin_commission_value]" id="admin_commission_value" class="form-control mt-2" value="5" type="number" placeholder='Sale Commission'>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>

                                                                        <script type="text/javascript">
                                                                            $("select.admin_sale_commission_type").on("change", function() {
                                                                                $con = $(this).parents(".form-group");
                                                                                $con.find(".toggle-container .percentage-value, .toggle-container .default-value").addClass('d-none');
                                                                                if ($(this).val() == 'default') {
                                                                                    $con.find(".toggle-container .default-value").removeClass("d-none");
                                                                                } else {
                                                                                    $con.find(".toggle-container .percentage-value").removeClass("d-none");
                                                                                }

                                                                                if ($(this).val() == 'percentage')
                                                                                    $("input[name='vendor[admin_commission_value]']").siblings('.currency-symbol').text('%');
                                                                                else
                                                                                    $("input[name='vendor[admin_commission_value]']").siblings('.currency-symbol').text('$');
                                                                            })

                                                                            $("select.admin_sale_commission_type").trigger("change");
                                                                        </script>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div role="tabpanel" class="tab-pane p-3" id="vendor_deposite_setting">
                                                    <div class="form-group">
                                                        <div class="alert alert-info mt-4 vendor-deposit-on-message ">
                                                            INFO! The deposit module is ON! This means, your vendors will deposit the amount from your setting and all the generated commissions under the vendor account will be reduced from the vendor deposit balance and will be added to the admin balance for paying
                                                            those generated commissions! </div>
                                                        <div class="alert alert-warning mt-4 vendor-deposit-off-message d-none">
                                                            ATTENTION! The deposit module is OFF! This means, you as admin will need to pay all the commissions that are generated by all your vendor's accounts! </div>
                                                        <label class="control-label">Status</label>
                                                        <select class="form-control" name="vendor[depositstatus]">
										<option value="0">Disable</option>
										<option value="1" selected>Enable</option>
									</select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label">Vendor Minimum Deposit</label>
                                                        <div class="input-group">
                                                            <div class="currency-symbol">$</div>
                                                            <input name="site[vendor_min_deposit]" value="50" class="form-control" type="number">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div role="tabpanel" class="tab-pane p-3" id="vendor_permission_setting">
                                                    <div class="form-group">
                                                        <label class="control-label">Vendor add new program</label>
                                                        <select class="form-control" name="market_vendor[marketaddnewprogram]">
										<option value="0">No need admin approval</option>
										<option value="1" >Need admin approval</option>
									</select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label">Vendor add new campaign</label>
                                                        <select class="form-control" name="market_vendor[marketaddnewcampaign]">
										<option value="0">No need admin approval</option>
										<option value="1" >Need admin approval</option>
									</select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label">Vendor add new store product</label>
                                                        <select class="form-control" name="market_vendor[marketaddnewstoreproduct]">
										<option value="0">No need admin approval</option>
										<option value="1" >Need admin approval</option>
									</select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label">Vendor External order campaign</label>
                                                        <select class="form-control" name="market_vendor[marketvendorexternalordercampaign]">
										<option value="1" >No need admin approval</option>
										<option value="0" selected>Need admin approval</option>
									</select>
                                                    </div>
                                                    <!-- <div class="form-group">
									<label class="control-label">Vendor Local store order</label>
									<select class="form-control" name="market_vendor[marketvendorlocalstoreorder]">
										<option value="1" >No need admin approval</option>
										<option value="0" selected>Need admin approval</option>
									</select>
								</div> -->
                                                    <div class="form-group">
                                                        <label class="control-label">Vendor Actions campaign</label>
                                                        <select class="form-control" name="market_vendor[marketvendoractionscampaign]">
										<option value="1" >No need admin approval</option>
										<option value="0" selected>Need admin approval</option>
									</select>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label">Vendor Click campaign</label>
                                                        <select class="form-control" name="market_vendor[marketvendorclickcampaign]">
										<option value="1" >No need admin approval</option>
										<option value="0" selected>Need admin approval</option>
									</select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 text-right">
                                            <button type="submit" class="btn btn-sm btn-primary btn-submit">Save Settings</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <link href="{% static 'dashboard/assets/js/summernote-0.8.12-dist/summernote-bs4.css' %}" rel="stylesheet">
                        <script src="{% static 'dashboard/assets/js/summernote-0.8.12-dist/summernote-bs4.js' %}"></script>


                        <script type="text/javascript">
                            $("select[name='market_vendor[commission_type]']").on('change', function() {
                                if ($(this).val() == 'percentage')
                                    $("input[name='market_vendor[commission_sale]']").siblings('.input-group-prepend').find('.input-group-text').text('%');
                                else
                                    $("input[name='market_vendor[commission_sale]']").siblings('.input-group-prepend').find('.input-group-text').text('$');
                            })

                            $("select[name='vendor[depositstatus]']").on('change', function() {
                                $(this).siblings('.alert').addClass('d-none');

                                if ($(this).val() == 1)
                                    $(this).siblings('.vendor-deposit-on-message').removeClass('d-none');
                                else
                                    $(this).siblings('.vendor-deposit-off-message').removeClass('d-none');
                            })

                            $('.setting-nnnav li a').on('shown.bs.tab', function(event) {
                                var x = $(event.target).attr('href');
                                $(".btn-submit").hide();

                                if (x != '#site-fronttemplate') {
                                    $(".btn-submit").show();
                                }
                                localStorage.setItem("last_pill", x);
                            });

                            $(document).on('ready', function() {
                                var last_pill = localStorage.getItem("last_pill");
                                if (last_pill) {
                                    $('[href="' + last_pill + '"]').click()
                                }
                            });

                            $('.setting-nnnav li a').on('shown.bs.tab', function(event) {
                                var x = $(event.target).attr('href');
                                localStorage.setItem("last_pill", x);
                            });

                            $("#setting-form").on('submit', function() {
                                $("#setting-form .alert-error").remove();
                                var affiliate_cookie = parseInt($(".input-affiliate_cookie").val());
                                if (affiliate_cookie <= 0 || affiliate_cookie > 365) {
                                    $(".input-affiliate_cookie").after("<div class='alert alert-danger alert-error'>Days Between 1 and 365</div>");
                                }
                                if ($("#setting-form .alert-error").length == 0) return true;
                                return false;
                            })

                            $(".btn-submit").on('click', function(evt) {
                                evt.preventDefault();
                                var formData = new FormData($("#setting-form")[0]);

                                $(".btn-submit").btn("loading");
                                formData = formDataFilter(formData);
                                $this = $("#setting-form");

                                $.ajax({
                                    type: 'POST',
                                    dataType: 'json',
                                    cache: false,
                                    contentType: false,
                                    processData: false,
                                    data: formData,
                                    success: function(result) {
                                        $(".btn-submit").btn("reset");
                                        $(".alert-dismissable").remove();

                                        $this.find(".has-error").removeClass("has-error");
                                        $this.find("span.text-danger").remove();

                                        if (result['location']) {
                                            window.location = result['location'];
                                        }

                                        if (result['success']) {
                                            $(".tab-content").prepend('<div class="alert mt-4 alert-info alert-dismissable">' + result['success'] + '</div>');
                                            var body = $("html, body");
                                            body.stop().animate({
                                                scrollTop: 0
                                            }, 500, 'swing', function() {});
                                        }

                                        if (result['errors']) {
                                            $.each(result['errors'], function(i, j) {
                                                $ele = $this.find('[name="' + i + '"]');
                                                if ($ele) {
                                                    $ele.parents(".form-group").addClass("has-error");
                                                    $ele.after("<span class='d-block text-danger'>" + j + "</span>");
                                                }
                                            });
                                        }
                                    },
                                })
                                return false;
                            });
                        </script>

                        <script type="text/javascript">
                            function resetNotify() {
                                $.ajax({
                                    url: 'resetnotify',
                                    type: 'POST',
                                    dataType: 'json',
                                    beforeSend: function() {},
                                    success: function(response) {
                                        if (response.status == 1)
                                            $(".ajax-notifications_count").text(0);
                                    },
                                })
                            }
                        </script>


                    </div>

                    <div class="modal modal-style" id="setting-widzard"></div>
                    <div class="modal modal-style" id="log-widzard"></div>

                    <div class="modal" id="model-ajaxError">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <img src="{% static 'dashboard/assets/images/ajax-warning.png' %}">
                                    <div class="-body"></div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-dismiss="modal">Dismiss</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <script type="text/javascript" src="{% static 'dashboard/assets/plugins/toastr/toastr.js' %}"></script>
                    <script type="text/javascript">
                        var serverErrorCode = {
                            100: 'Continue',
                            101: 'Switching Protocols',
                            102: 'Processing',
                            200: 'OK',
                            201: 'Created',
                            202: 'Accepted',
                            203: 'Non-Authoritative Information',
                            204: 'No Content',
                            205: 'Reset Content',
                            206: 'Partial Content',
                            207: 'Multi-Status',
                            208: 'Already Reported',
                            226: 'IM Used',
                            300: 'Multiple Choices',
                            301: 'Moved Permanently',
                            302: 'Found',
                            303: 'See Other',
                            304: 'Not Modified',
                            305: 'Use Proxy',
                            306: 'Switch Proxy',
                            307: 'Temporary Redirect',
                            308: 'Permanent Redirect',
                            400: 'Bad Request',
                            401: 'Unauthorized',
                            402: 'Payment Required',
                            403: 'Forbidden',
                            404: 'Not Found',
                            405: 'Method Not Allowed',
                            406: 'Not Acceptable',
                            407: 'Proxy Authentication Required',
                            408: 'Request Timeout',
                            409: 'Conflict',
                            410: 'Gone',
                            411: 'Length Required',
                            412: 'Precondition Failed',
                            413: 'Request Entity Too Large',
                            414: 'Request-URI Too Long',
                            415: 'Unsupported Media Type',
                            416: 'Requested Range Not Satisfiable',
                            417: 'Expectation Failed',
                            418: 'I am a teapot',
                            419: 'Authentication Timeout',
                            420: 'Enhance Your Calm',
                            420: 'Method Failure',
                            422: 'Unprocessable Entity',
                            423: 'Locked',
                            424: 'Failed Dependency',
                            424: 'Method Failure',
                            425: 'Unordered Collection',
                            426: 'Upgrade Required',
                            428: 'Precondition Required',
                            429: 'Too Many Requests',
                            431: 'Request Header Fields Too Large',
                            444: 'No Response',
                            449: 'Retry With',
                            450: 'Blocked by Windows Parental Controls',
                            451: 'Redirect',
                            451: 'Unavailable For Legal Reasons',
                            494: 'Request Header Too Large',
                            495: 'Cert Error',
                            496: 'No Cert',
                            497: 'HTTP to HTTPS',
                            499: 'Client Closed Request',
                            500: 'Internal Server Error',
                            501: 'Not Implemented',
                            502: 'Bad Gateway',
                            503: 'Service Unavailable',
                            504: 'Gateway Timeout',
                            505: 'HTTP Version Not Supported',
                            506: 'Variant Also Negotiates',
                            507: 'Insufficient Storage',
                            508: 'Loop Detected',
                            509: 'Bandwidth Limit Exceeded',
                            510: 'Not Extended',
                            511: 'Network Authentication Required',
                            598: 'Network read timeout error',
                            599: 'Network connect timeout error',
                        }

                        toastr.options = {
                            "closeButton": true,
                            "debug": false,
                            "newestOnTop": true,
                            "progressBar": true,
                            "positionClass": "toast-top-right",
                            "preventDuplicates": false,
                            "onclick": null,
                            "showDuration": "300",
                            "hideDuration": "20000",
                            "timeOut": "20000",
                            "extendedTimeOut": "20000",
                            "showEasing": "swing",
                            "hideEasing": "linear",
                            "showMethod": "fadeIn",
                            "hideMethod": "fadeOut"
                        }

                        function show_tost(type, title, message) {
                            toastr[type](message, title)
                        }

                        $(".btn-setting").on('click', function() {
                            $this = $(this);
                            $("#setting-widzard").modal({
                                backdrop: 'static',
                                keyboard: false
                            });

                            $("#setting-widzard").html('Loading');

                            $.ajax({
                                url: 'https://demo.affiliatepro.org/setting/getModal',
                                type: 'POST',
                                dataType: 'json',
                                data: {
                                    'key': $this.attr('data-key'),
                                    'type': $this.attr('data-type'),
                                },
                                // beforeSend:function(){ $this.btn("loading"); },
                                // complete:function(){ $this.btn("reset"); },
                                success: function(json) {
                                    if (json['html']) {
                                        $("#setting-widzard").html(json['html']);
                                    }
                                },
                            })
                        })


                        $(document).delegate('.allow-number', 'keypress keyup blur', function(event) {
                            $(this).val($(this).val().replace(/[^0-9\.]/g, ''));
                            if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
                                event.preventDefault();
                            }
                        });

                        $(document).delegate("[data-log]", 'click', function() {
                            $this = $(this);

                            var data = {};
                            var search = $this.attr('data-extra');
                            if (search) {
                                data = JSON.parse('{"' + decodeURI(search).replace(/"/g, '\\"').replace(/&/g, '","').replace(/=/g, '":"') + '"}')
                            }

                            data['type'] = $this.attr("data-log");
                            $.ajax({
                                url: 'logs',
                                type: 'POST',
                                dataType: 'json',
                                data: data,
                                beforeSend: function() {
                                    $this.btn("loading");
                                },
                                complete: function() {
                                    $this.btn("reset");
                                },
                                success: function(json) {
                                    if (json['html']) {
                                        $("#log-widzard").modal({
                                            backdrop: 'static',
                                            keyboard: false
                                        });
                                        $("#log-widzard").html(json['html']);
                                    }
                                },
                            })
                        })

                        $(".password-group .input-group-prepend button").on('click', function() {
                            $input = $(this).parents(".password-group").find("input");
                            $i = $(this).parents(".password-group").find("i");
                            if ($i.hasClass("fa-eye")) {
                                $i.addClass("fa-eye-slash");
                                $i.removeClass("fa-eye");
                                $input.attr('type', 'text');
                            } else {
                                $i.addClass("fa-eye");
                                $i.removeClass("fa-eye-slash");
                                $input.attr('type', 'password');
                            }
                        })

                        $(document).ajaxComplete(function myErrorHandler(event, xhr, ajaxOptions, thrownError) {
                            var statusCode = xhr.status;


                            if (statusCode != 200 && ajaxOptions.type == 'POST') {
                                var title = '';
                                var body = '';

                                title = 'Internal Server Error';
                                body += '<h3>Sorry, an error has occured.</h3>';

                                if (serverErrorCode[statusCode]) {
                                    body += "<p>Error Message : " + serverErrorCode[statusCode] + "</p>";
                                    body += "<p>Error Code : " + statusCode + "</p>";

                                    $("#model-ajaxError .modal-title").html(title);
                                    $("#model-ajaxError .modal-body .-body").html(body);
                                    $("#model-ajaxError").modal("show");
                                } else {
                                    body += '<p>Error Message : Uknown Error </p>';
                                }

                                $(".btn-loading").removeClass('btn-loading');
                            }
                        });
                    </script>
                </div>
                <div class="dashboard-footer">
                    <div class="d-flex align-items-center justify-content-between flex-wrap">
                        <div class="footer-rights">
                            <img src="{% static 'dashboard/assets/template/images/footer-logo.png' %}" alt="Logo:">
                            <p>Affiliate Script Footer</p>
                        </div>
                        <a href="script_details">
                            <div class="text-right script-right">
                                <img src="{% static 'dashboard/assets/template/images/script-icon.png' %}" alt="">
                                <span>SCRIPT VERSION</span>
                                <span>6.0.0.1</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <div class="modal" id="payment-detail_modal">

                <div class="modal-dialog modal-lg">

                    <div class="modal-content">

                        <div class="modal-header">

                            <h4 class="modal-title mt-0">User Payment Details</h4>

                            <button type="button" class="close" data-dismiss="modal">&times;</button>

                        </div>

                        <div class="modal-body">

                            <h4 class="modal-title mt-0">Bank Details</h4>

                            <div class="table-rep-plugin">

                                <div class="table-responsive b-0" data-pattern="priority-columns">

                                    <table id="tech-companies-1" class="table  table-striped">

                                        <thead>

                                            <tr>

                                                <th class="txt-cntr">Bank Name</th>

                                                <th class="txt-cntr">Account Number</th>

                                                <th class="txt-cntr">Account Name</th>

                                                <th class="txt-cntr">IFSC Code</th>

                                            </tr>

                                        </thead>

                                        <tbody class="bank-details"> </tbody>

                                    </table>

                                </div>

                            </div>

                            <h4 class="modal-title mt-0">Paypal Emails</h4>

                            <div class="table-rep-plugin">

                                <div class="table-responsive b-0" data-pattern="priority-columns">

                                    <table id="tech-companies-1" class="table  table-striped">

                                        <thead>

                                            <tr>
                                                <th class="txt-cntr"></th>

                                                <th class="txt-cntr">Email</th>

                                            </tr>

                                        </thead>

                                        <tbody class="paypal-details"> </tbody>

                                    </table>

                                </div>

                            </div>


                            <h4 class="modal-title mt-0">User Details</h4>

                            <div class="table-rep-plugin">

                                <div class="table-responsive b-0" data-pattern="priority-columns">

                                    <table id="tech-companies-1" class="table  table-striped">

                                        <tbody class="user-details"></tbody>

                                    </table>

                                </div>

                            </div>

                            <div class="modal-footer">

                                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>

                            </div>

                        </div>

                    </div>

                </div>

            </div>

            <script type="text/javascript">
                $(document).delegate(".only-number-allow", "keypress", function(e) {
                    if (e.which != 46 && e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57))
                        return false;
                });

                $(document).on('ready', function() {
                    if (getCookie('hide_welcome') != 'true')
                        $("#welcome-modal").modal("show");
                })

                function setCookie(cname, cvalue, exdays) {
                    var d = new Date();
                    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));

                    var expires = "expires=" + d.toUTCString();
                    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
                }

                function readURLAndSetValue(input, name, placeholder) {

                    if (input.files && input.files[0]) {
                        var reader = new FileReader();

                        reader.onload = function(e) {
                            $("input[name='" + name + "']").val('image.jpg');
                            $(placeholder).attr('src', e.target.result);
                        }

                        reader.readAsDataURL(input.files[0]);
                    }
                }

                function readURL(input, placeholder) {

                    if (input.files && input.files[0]) {
                        var reader = new FileReader();

                        reader.onload = function(e) {
                            $(placeholder).attr('src', e.target.result);
                        }

                        reader.readAsDataURL(input.files[0]);
                    }
                }

                function getCookie(cname) {

                    var name = cname + "=";
                    var ca = document.cookie.split(';');

                    for (var i = 0; i < ca.length; i++) {
                        var c = ca[i];

                        while (c.charAt(0) == ' ') {
                            c = c.substring(1);
                        }

                        if (c.indexOf(name) == 0)
                            return c.substring(name.length, c.length);
                    }

                    return "";
                }

                $('.hide-welcome').on('click', function() {

                    setCookie("hide_welcome", "true", 365)

                    $("#welcome-modal").modal("hide");

                })
            </script>


            <div class="modal" id="model-shorturl"></div>

            <script type="text/javascript">
                $(".btn-delete").on('click', function() {
                    return confirm('Are you sure ?');
                })

                $(document).delegate("[payment_detail]", 'click', function(e) {

                    e.preventDefault();

                    e.stopPropagation();

                    $this = $(this);

                    var user_id = $this.attr("payment_detail");

                    $.ajax({

                        url: 'getpaymentdetail/' + user_id,

                        type: 'POST',

                        dataType: 'json',

                        beforeSend: function() {
                            $this.btn("loading");
                        },

                        complete: function() {
                            $this.btn("reset");
                        },

                        success: function(json) {

                            $('#payment-detail_modal').modal("show");

                            var html = '';

                            $.each(json['paymentlist'], function(i, j) {

                                html += '<tr>';

                                html += '<th>' + j['payment_bank_name'] + '</th>';

                                html += '<th>' + j['payment_account_number'] + '</th>';

                                html += '<th>' + j['payment_account_name'] + '</th>';

                                html += '<th>' + j['payment_ifsc_code'] + '</th>';

                                html += '</tr>';

                            })

                            $('#payment-detail_modal .bank-details').html(html);

                            var html = '';

                            $.each(json['paypalaccounts'], function(i, j) {

                                html += '<tr>';

                                html += '<th>' + (i + 1) + '</th>';

                                html += '<th>' + j['paypal_email'] + '</th>';

                                html += '</tr>';

                            })

                            $('#payment-detail_modal .paypal-details').html(html);

                            var html = '';

                            html += '<tr>';

                            html += '<th>First Name</th>';

                            html += '<td>' + json.user.firstname + '</td>';

                            html += '</tr>';

                            html += '<tr>';

                            html += '<th>Last Name</th>';

                            html += '<td>' + json.user.lastname + '</td>';

                            html += '</tr>';

                            html += '<tr>';

                            html += '<th>Username</th>';

                            html += '<td>' + json.user.username + '</td>';

                            html += '</tr>';

                            html += '<tr>';

                            html += '<th>Email</th>';

                            html += '<td>' + json.user.email + '</td>';

                            html += '</tr>';

                            html += '<tr>';

                            html += '<th>Phone</th>';

                            html += '<td>' + json.user.phone + '</td>';

                            html += '</tr>';

                            html += '<tr>';

                            html += '<th>Address</th>';

                            html += '<td>' + json.user.address + '</td>';

                            html += '</tr>';

                            html += '<tr>';

                            html += '<th>State</th>';

                            html += '<td>' + json.user.state + '</td>';

                            html += '</tr>';

                            html += '<tr>';

                            html += '<th>Country</th>';

                            html += '<td>' + json.user.country + '</td>';

                            html += '</tr>';

                            $('#payment-detail_modal .user-details').html(html);
                        },
                    })
                })
            </script>

            <script src="{% static 'dashboard/assets/js/jquery-ui.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/jquery-confirm.min.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/popper.min.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/bootstrap.min.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/modernizr.min.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/detect.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/fastclick.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/jquery.slimscroll.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/jquery.blockUI.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/waves.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/jquery.nicescroll.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/jquery.scrollTo.min.js' %}"></script>

            <script src="{% static 'dashboard/assets/vertical/assets/plugins/skycons/skycons.min.js' %}"></script>

            <script src="{% static 'dashboard/assets/vertical/assets/plugins/raphael/raphael-min.js' %}"></script>

            <script src="{% static 'dashboard/assets/vertical/assets/plugins/morris/morris.min.js' %}"></script>

            <script src="{% static 'dashboard/assets/vertical/assets/plugins/magnific-popup/jquery.magnific-popup.min.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/lightbox.js' %}"></script>

            <script src="{% static 'dashboard/assets/js/jssocials-1.4.0/jssocials.min.js' %}"></script>

            <link href="https://demo.affiliatepro.org/assets/js/jssocials-1.4.0/jssocials.css' %}" type="text/css" rel="stylesheet" />

            <link href="https://demo.affiliatepro.org/assets/js/jssocials-1.4.0/jssocials-theme-flat.css' %}" type="text/css" rel="stylesheet" />

            <script type="text/javascript">
                let leftHeight = $(".left-menu").height();
                let navbarHeight = $(".dashboard-navbar").height();
                let errorHeight = $(".server-errors").height();
                let footerHeight = $(".dashboard-footer").height();
                let elTotalheight = navbarHeight + errorHeight + footerHeight;
                let contentHeight = leftHeight - elTotalheight - 26;
                $(".content-wrapper").css('min-height', contentHeight);

                $(document).delegate(".copy-input input", 'click', function() {
                    $(this).select();
                })

                $(document).delegate('[copyToClipboard]', "click", function() {
                    $this = $(this);

                    var $temp = $("<input>");

                    $("body").append($temp);

                    $temp.val($(this).attr('copyToClipboard')).select();

                    document.execCommand("copy");

                    $temp.remove();

                    $this.tooltip('hide').attr('data-original-title', 'Copied!').tooltip('show');

                    setTimeout(function() {
                        $this.tooltip('hide');
                    }, 500);
                });

                $('[copyToClipboard]').tooltip({
                    trigger: 'click',
                    placement: 'bottom'

                });

                (function($) {
                    $.fn.button = function(action) {
                        var self = $(this);
                        if (action == 'loading') {
                            if ($(self).attr("disabled") == "disabled") {
                                //e.preventDefault();
                            }

                            $(self).attr("disabled", "disabled");

                            $(self).attr('data-btn-text', $(self).html());

                            $(self).html('<i class="fa fa-spinner fa-spin"></i>' + $(self).text());
                        }

                        if (action == 'reset') {
                            $(self).html($(self).attr('data-btn-text'));
                            $(self).removeAttr("disabled");
                        }
                    }

                })(jQuery);
            </script>

            <script src="{% static 'dashboard/assets/js/app.js' %}"></script>

            <link href="https://demo.affiliatepro.org/assets/js/summernote-0.8.12-dist/summernote-bs4.css' %}" rel="stylesheet">

            <script src="{% static 'dashboard/assets/js/summernote-0.8.12-dist/summernote-bs4.js' %}"></script>

            <div class="modal fade" id="ip-flag_model">

                <div class="modal-dialog">

                    <div class="modal-content">

                        <div class="modal-header">

                            <h4 class="modal-title">All IPs Details</h4>

                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

                        </div>

                        <div class="modal-body"></div>

                        <div class="modal-footer">

                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>

                        </div>

                    </div>

                </div>

            </div>

            <script>
                $(".select2-input").select2();

                $(document).delegate(".view-all", 'click', function() {
                    var data = $(this).find("span").html();
                    var html = '<table class="table table-hover">';

                    data = JSON.parse(data);

                    html += '<tr>';

                    html += ' <th>' + 'admin.ip' + '</th>';

                    html += ' <th width="30px">' + 'admin.country' + '</th>';

                    html += '</tr>';

                    $.each(data, function(i, j) {
                        html += '<tr>';

                        html += ' <td>' + j['ip'] + '</td>';

                        html += ' <td><img style="width: 20px;" src="{% static 'dashboard/assets/vertical/assets/images/flags/' + j['country_code'].toLowerCase() + '.png' %}" ></td>';

                        html += '</tr>';
                    })

                    html += '</table>';

                    $("#ip-flag_model").modal("show");

                    $("#ip-flag_model .modal-body").html(html);
                })

                $('[data-toggle="tooltip"]').tooltip();

                if ($('#morris-area-chart').length > 0) {
                    var areaData = [

                        {
                            y: '2011',
                            a: 10,
                            b: 15
                        },

                        {
                            y: '2012',
                            a: 30,
                            b: 35
                        },

                        {
                            y: '2013',
                            a: 10,
                            b: 25
                        },

                        {
                            y: '2014',
                            a: 55,
                            b: 45
                        },

                        {
                            y: '2015',
                            a: 30,
                            b: 20
                        },

                        {
                            y: '2016',
                            a: 40,
                            b: 35
                        },

                        {
                            y: '2017',
                            a: 10,
                            b: 25
                        },

                        {
                            y: '2018',
                            a: 25,
                            b: 30
                        }

                    ];

                    Morris.Area({

                        element: 'morris-area-chart',

                        pointSize: 3,

                        lineWidth: 2,

                        data: areaData,

                        xkey: 'y',

                        ykeys: ['a', 'b'],

                        labels: ['Orders', 'Sales'],

                        resize: true,

                        hideHover: 'auto',

                        gridLineColor: '#eef0f2',

                        lineColors: ['#00c292', '#03a9f3'],

                        lineWidth: 0,

                        fillOpacity: 0.1,

                        xLabelMargin: 10,

                        yLabelMargin: 10,

                        grid: false,

                        axes: false,

                        pointSize: 0

                    });
                }

                $(document).on('ready', function() {

                    if ($('#morris-donut-chart').length > 0) {
                        var donutData = [];

                        Morris.Donut({

                            element: 'morris-donut-chart',

                            data: donutData,

                            resize: true,

                            colors: ['#40a4f1', '#5b6be8', '#c1c5e2', '#e785da', '#00bcd2']

                        });

                    }

                    if ($("#boxscroll").length > 0)
                        $("#boxscroll").niceScroll({
                            cursorborder: "",
                            cursorcolor: "#cecece",
                            boxzoom: true
                        });

                    if ($("#boxscroll2").length > 0)
                        $("#boxscroll2").niceScroll({
                            cursorborder: "",
                            cursorcolor: "#cecece",
                            boxzoom: true
                        });


                    if ($(".clickable-row").length > 0) {
                        $(".clickable-row").on('click', function() {
                            window.location = $(this).data("href");
                        });
                    }

                    if ($("#Country").length > 0) {
                        $('#Country').on('change', function() {
                            country_id = $(this).val();

                            $.ajax({

                                type: "POST",

                                url: "getstate",

                                data: 'country_id=' + country_id,

                                success: function(data) {

                                    $("#StateProvince").html(data);

                                }

                            });

                        });
                    }

                });


                function shownofication(id, url) {

                    $.ajax({

                        type: "POST",

                        url: "updatenotify",

                        data: 'id=' + id,

                        dataType: 'json',

                        success: function(data) {

                            window.location.href = data['location'];

                        }

                    });

                }

                $(document).on('ready', function() {
                    $('.summernote-img').each(function() {
                        sumNote($(this));
                    });

                });

                function sumNote(element) {
                    var height = $(element).attr("data-height") ? $(element).attr("data-height") : 500;

                    $(element).summernote({

                        disableDragAndDrop: true,

                        height: height,


                        toolbar: [

                            ['style', ['style']],

                            ['font', ['bold', 'underline', 'clear']],

                            ['fontname', ['fontname']],

                            ['color', ['color']],

                            ['para', ['ul', 'ol', 'paragraph']],

                            ['table', ['table']],

                            ['insert', ['link', 'image', 'picture', 'video']],

                            ['view', ['fullscreen', 'codeview', 'help']]

                        ],

                        buttons: {

                            image: function() {

                                var ui = $.summernote.ui;

                                // create button

                                var button = ui.button({

                                    contents: '<i class="fa fa-image" />',

                                    tooltip: false,

                                    click: function() {

                                        $('#modal-image').remove();



                                        $.ajax({

                                            url: 'https://demo.affiliatepro.org/filemanager',

                                            dataType: 'html',

                                            beforeSend: function() {

                                            },
                                            complete: function() {

                                            },
                                            success: function(html) {

                                                $('body').append('<div id="modal-image" class="modal fade">' + html + '</div>');

                                                $('#modal-image').modal('show');

                                                $('#modal-image').delegate('.image-box .thumbnail', 'click', function(e) {

                                                    e.preventDefault();

                                                    $(element).summernote('insertImage', $(this).attr('href'));

                                                    $('#modal-image').modal('hide');

                                                });

                                            }

                                        });

                                    }

                                });



                                return button.render();

                            }

                        }

                    });

                }
            </script>
</div>
  {% endblock %}